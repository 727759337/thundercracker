package {	import com.adobe.images.PNGEncoder;	import flash.display.MovieClip;	import flash.events.Event;	import flash.geom.Rectangle;	import flash.filesystem.File;	import flash.display.BitmapData;	import flash.geom.Matrix;	import flash.utils.ByteArray;	import flash.filesystem.FileStream;	import flash.filesystem.FileMode;	import flash.geom.Point;		public class WSExport extends MovieClip {				public static const kViewport : Rectangle = new Rectangle(72, 0, 56, 80);						public function WSExport() {			loaderInfo.addEventListener(Event.INIT, onInit);		}				function onInit(e:Event):void {			var result : BitmapData = new BitmapData(kViewport.width, kViewport.height * (totalFrames/4), true, 0);			for(var i:int=1; i<=totalFrames; i+=4) {				gotoAndStop(i);				exportImage(((i-1)/4), result);			}			var file:File = new File(File.desktopDirectory.nativePath + "/anim.png");			var writer:FileStream = new FileStream();			writer.open(file, FileMode.WRITE);			writer.writeBytes(PNGEncoder.encode(result));			writer.close();		}				function exportImage(index:int, result:BitmapData):void {			var bmp : BitmapData = new BitmapData(kViewport.width, kViewport.height, true, 0);			bmp.draw(this, new Matrix(1, 0, 0, 1, -kViewport.x, -kViewport.y));			result.copyPixels(bmp, new Rectangle(0, 0, kViewport.width, kViewport.height), new Point(0,index * kViewport.height));		}			}	}